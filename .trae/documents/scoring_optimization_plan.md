# 能量评分规则优化计划 (Scoring Optimization Plan)

用户反馈“综合评分”从未超过 60 分，体验不佳。这通常是因为：
1.  基础分设置偏低 (50分)。
2.  减分项（克、泄、冲、煞）权重过高或触发过于频繁。
3.  `dailyFortune` 综合评分计算时，被夜间/睡眠时段的低分拉低了平均值。
4.  缺乏“正态分布”或“鼓励机制”，导致分数很难达到“优秀”区间。

本计划旨在调整评分算法，使分数分布更符合用户心理预期（即：大部分日子应该是“平稳”或“小吉”，偶尔有“大吉”，极少出现“大凶”），提升用户开心度。

## 1. 调整 `calculateHourEnergy` (src/utils/tyme.js)

### 1.1 提高基础分
*   **现状**: `let score = 50`
*   **修改**: `let score = 60` (及格线起步)

### 1.2 调整加减分权重 (鼓励性调整)

| 因素 | 原规则 | 新规则 | 说明 |
| :--- | :--- | :--- | :--- |
| **日柱生助日主** | +18 | **+20** | 加强日柱得力的正面反馈 |
| **日柱同类** | +12 | **+15** | |
| **日柱克日主** | -15 | **-10** | 降低克制带来的挫败感 |
| **日柱被克** | -8 | **-5** | |
| **时辰喜神 (天干)** | +12 | **+15** | 增加喜用神权重 |
| **时辰忌神 (天干)** | -12 | **-8** | 降低忌神权重 |
| **时辰喜神 (地支)** | +8 | **+10** | |
| **时辰忌神 (地支)** | -8 | **-5** | |
| **吉神 (如天乙)** | +10 | **+15** | 让贵人出现时惊喜感更强 |
| **凶煞 (如日破)** | -12 | **-10** | 适当降低凶煞影响 |

### 1.3 移除或降低部分冲突减分
*   `时辰克日主` (-10) -> **-5**
*   `时辰冲日支` (-10) -> **-8**

## 2. 优化 `dailyFortune` 计算逻辑 (src/stores/energy.js)

### 2.1 调整加权平均算法
*   **现状**: 08:00-22:00 权重 1.2，其他 0.8。
*   **问题**: 睡眠时间（通常是平运或低运）依然占了相当大比重。
*   **修改**:
    *   **活跃时段 (09:00 - 21:00)**: 权重 **1.5**
    *   **次活跃时段 (07:00-09:00, 21:00-23:00)**: 权重 **1.0**
    *   **睡眠时段 (23:00 - 07:00)**: 权重 **0.3** (大幅降低夜间影响，除非夜间有极大凶煞)

### 2.2 引入“基础加成”
*   在计算出 `overallScore` 后，如果分数 < 60 且没有严重凶煞（如岁破/日破），强制拉升到 60-65 区间，给用户“平稳”的安抚。
*   或者直接给 `overallScore` 增加一个 **+5 分的“乐观系数”**。

## 3. 验证与测试
*   修改后，随机抽取几天进行模拟，确保：
    *   普通日子的分数在 65-75 之间。
    *   好日子能达到 80-95。
    *   只有极差的日子才会低于 50。

## 4. 执行步骤
1.  修改 `src/utils/tyme.js` 中的 `calculateHourEnergy` 函数。
2.  修改 `src/stores/energy.js` 中的 `dailyFortune` 计算逻辑。
3.  （可选）更新 `src/utils/tyme.spec.js` 适配新的分值断言。
