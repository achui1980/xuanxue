# 八字能量评分算法 V2.1 (Optimized)

用户希望优化评分算法，避免分数过低（从未超过 60 分）带来的挫败感。本算法在保留五行生克严谨性的基础上，引入“基础分提升”和“鼓励性权重”，确保大多数日子的评分落在“平稳”至“小吉”区间（60-80分）。

## 1. 核心原则
1.  **提升基准线**: 基础分从 50 提升至 **60**（及格线起步）。
2.  **正向激励**: 吉神/喜用神的加分幅度 > 凶煞/忌神的减分幅度。
3.  **活跃时段优先**: 在计算日运时，大幅降低睡眠时段（23:00-07:00）的权重。
4.  **平滑处理**: 避免极端低分，除非遇到重大凶煞（如岁破、日破）。

## 2. 时辰能量评分 (`calculateHourEnergy`)

### 2.1 基础分
`let score = 60` (原 50)

### 2.2 日柱影响 (权重最高)
| 关系 | 旧规则 | **新规则** | 说明 |
| :--- | :--- | :--- | :--- |
| 日柱生助日主 | +18 | **+20** | 加强 |
| 日柱同类 | +12 | **+15** | 加强 |
| 日柱克日主 | -15 | **-10** | 降低挫败感 |
| 日柱被日主克 | -8 | **-5** | 降低 |
| 日支六合 | +10 | **+10** | 保持 |
| 日支六冲 | -12 | **-10** | 降低 |
| 日干喜神 | +10 | **+12** | 加强 |
| 日干忌神 | -10 | **-8** | 降低 |

### 2.3 时辰影响 (权重次之)
| 关系 | 旧规则 | **新规则** | 说明 |
| :--- | :--- | :--- | :--- |
| 时干喜神 | +12 | **+15** | 显著加分 |
| 时干忌神 | -12 | **-8** | 降低 |
| 时支喜神 | +8 | **+10** | 加强 |
| 时支忌神 | -8 | **-5** | 降低 |
| 时干生助日主 | +8 | **+10** | 加强 |
| 时干同类 | +5 | **+8** | 加强 |
| 时干克日主 | -10 | **-5** | 降低 |
| 时支冲日支 | -10 | **-8** | 降低 |

### 2.4 神煞影响 (修正系数)
| 神煞 | 旧规则 | **新规则** | 说明 |
| :--- | :--- | :--- | :--- |
| **天乙贵人** | +10 | **+15** | 大吉 |
| **天德/月德** | +5 | **+8** | 中吉 |
| **文昌/魁罡** | +6/+3 | **+8/+5** | 小吉 |
| **红鸾/天喜** | +5 | **+8** | 小吉 |
| **岁破/日破** | -12 | **-12** | 维持大凶警示 |
| **劫煞/羊刃** | -5/-4 | **-5/-4** | 维持 |

## 3. 日运综合评分 (`dailyFortune`)

### 3.1 活跃时段加权
不再简单使用全天平均分，而是采用**加权平均**：

*   **活跃时段 (09:00 - 21:00)**: 权重 **2.0** (工作、生活主要时段)
*   **过渡时段 (07:00-09:00, 21:00-23:00)**: 权重 **1.0**
*   **睡眠时段 (23:00 - 07:00)**: 权重 **0.2** (几乎不影响日运)

### 3.2 波动性奖励
*   如果全天分数方差小（稳定），额外 **+5** 分（原规则保留）。

### 3.3 乐观系数
*   最终得分额外 **+2** 分（心理安慰分）。

## 4. 实施计划
1.  **更新文档**: 将此算法写入 `bazi-energy-algorithm-v2.md`。
2.  **代码实现**:
    *   修改 `src/utils/tyme.js` 中的 `calculateHourEnergy`。
    *   修改 `src/stores/energy.js` 中的 `dailyFortune` 计算逻辑。
3.  **验证**: 运行测试确保无逻辑错误。
